<!-- 

Author : ChungYi Fu (Kaohsiung, Taiwan)   2024/9/29 15:30
https://www.facebook.com/francefu

JavaScript
https://fustyles.github.io/BlocklyResearch/Variable/ADD_VARIABLE/JavaScript.html

Python
https://fustyles.github.io/BlocklyResearch/Variable/ADD_VARIABLE/Python.html

-->

<!DOCTYPE PY>
<html>
<head>
  <meta charset="utf-8">
  <title>Demo Blockly (PYTHON)</title>
	<script src="js/blockly_compressed.js"></script>
	<script src="js/blocks_compressed.js"></script>
	<script src="js/python_compressed.js"></script>
	<script src="js/en.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>	
</head>
<body>
<div id="blocklyDiv" style="position: absolute; left: 0px; top: 0px; height: 600px; width: 600px;">

<script>
	
	<!-- 工具箱自訂積木語系(en.js) -->
	
	Blockly.Msg["HELLOWORLD_NAME"] = "CUSTOM BLOCKS";
	Blockly.Msg["HELLOWORLD_MSG"] = "Alert";
	Blockly.Msg["HELLOWORLD_GET"] = "Get String";
	Blockly.Msg["HELLOWORLD_HUE"] = "100";
	
</script>

<script>
	
	<!-- 工具箱自訂積木定義內容(block.js) -->
	
	Blockly.Blocks['test1'] = {
	  init: function() {
		this.appendDummyInput()
		    .appendField(Blockly.Msg["HELLOWORLD_MSG"]);
		this.appendValueInput("message")
		    .setCheck(null);
		this.setInputsInline(!0);
		this.setPreviousStatement(!0);
		this.setNextStatement(!0);		  
		this.setColour(Blockly.Msg["HELLOWORLD_HUE"]);
	  }
	};
	
	Blockly.Blocks['test2'] = {
	  init: function() {
		this.appendDummyInput()
		    .appendField(Blockly.Msg["HELLOWORLD_GET"]);
		this.setInputsInline(!0);
		this.setOutput(!0);	  
		this.setColour(Blockly.Msg["HELLOWORLD_HUE"]);
	  }
	};	
	
</script>

<script>
	
	<!-- 工具箱自訂積木產出程式碼內容(Python.js) -->

	python.pythonGenerator.forBlock['test1'] = function(block, generator) {
		python.pythonGenerator.definitions_['messagebox'] =	'import tkinter as tk\n'
								+'from tkinter import messagebox\n'
								+'root = tk.Tk()\nroot.withdraw()';
								
		var message = generator.valueToCode(block, 'message', python.Order.ATOMIC);
		var code = "messagebox.showwarning('Message Box'," + message + ")\n";
		return code;
	};
	
	python.pythonGenerator.forBlock['test2'] = function(block, generator) {
		var code = "'Hello World'";
		return [code, python.Order.NONE];
	};	
	
</script>
	
<script>

	<!-- 工具箱系統目錄語系(en.js) -->

	Blockly.Msg["LOGIC_NAME"] = "LOGIC";
	Blockly.Msg["LOGIC_HUE"] = "210";
	Blockly.Msg["LOOPS_NAME"] = "LOOPS";
	Blockly.Msg["LOOPS_HUE"] = "120";
	Blockly.Msg["MATH_NAME"] = "MATH";
	Blockly.Msg["MATH_HUE"] = "230";
	Blockly.Msg["TEXTS_NAME"] = "TEXTS";
	Blockly.Msg["TEXTS_HUE"] = "160";
	Blockly.Msg["LISTS_NAME"] = "LISTS";
	Blockly.Msg["LISTS_HUE"] = "260";
	Blockly.Msg["VARIABLES_NAME"] = "VARIABLES";
	Blockly.Msg["VARIABLES_HUE"] = "330";
	Blockly.Msg["PROCEDURES_NAME"] = "PROCEDURES";
	Blockly.Msg["PROCEDURES_HUE"] = "290";

	var toolbox_standard = ''
	+ '<category name="%{BKY_LOGIC_NAME}" colour="%{BKY_LOGIC_HUE}">'
	+   '<block type="controls_if"></block>'
	+   '<block type="logic_compare"></block>'
	+   '<block type="logic_operation"></block>'
	+   '<block type="logic_negate"></block>'
	+   '<block type="logic_boolean"></block>'
	+   '<block type="logic_null"></block>'
	+   '<block type="logic_ternary"></block>'
	+ '</category>'
	+ '<category name="%{BKY_LOOPS_NAME}" colour="%{BKY_LOOPS_HUE}">'
	+   '<block type="controls_repeat_ext">'
	+     '<value name="TIMES">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">10</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="controls_whileUntil"></block>'
	+   '<block type="controls_for">'
	+     '<value name="FROM">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">1</field>'
	+       '</shadow>'
	+     '</value>'
	+     '<value name="TO">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">10</field>'
	+       '</shadow>'
	+     '</value>'
	+     '<value name="BY">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">1</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="controls_forEach"></block>'
	+   '<block type="controls_flow_statements"></block>'
	+ '</category>'
	+ '<category name="%{BKY_MATH_NAME}" colour="%{BKY_MATH_HUE}">'
	+   '<block type="math_number" gap="32">'
	+     '<field name="NUM">123</field>'
	+   '</block>'
	+   '<block type="math_arithmetic">'
	+     '<value name="A">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">1</field>'
	+       '</shadow>'
	+     '</value>'
	+     '<value name="B">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">1</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="math_single">'
	+     '<value name="NUM">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">9</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="math_trig">'
	+     '<value name="NUM">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">45</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="math_constant"></block>'
	+   '<block type="math_number_property">'
	+     '<value name="NUMBER_TO_CHECK">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">0</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="math_round">'
	+     '<value name="NUM">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">3.1</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="math_on_list"></block>'
	+   '<block type="math_modulo">'
	+     '<value name="DIVIDEND">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">64</field>'
	+       '</shadow>'
	+     '</value>'
	+     '<value name="DIVISOR">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">10</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="math_constrain">'
	+     '<value name="VALUE">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">50</field>'
	+       '</shadow>'
	+     '</value>'
	+     '<value name="LOW">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">1</field>'
	+       '</shadow>'
	+     '</value>'
	+     '<value name="HIGH">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">100</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="math_random_int">'
	+     '<value name="FROM">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">1</field>'
	+       '</shadow>'
	+     '</value>'
	+     '<value name="TO">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">100</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="math_random_float"></block>'
	+ '</category>'
	+ '<category name="%{BKY_TEXTS_NAME}" colour="%{BKY_TEXTS_HUE}">'
	+   '<block type="text"></block>'
	+   '<block type="text_join"></block>'
	+   '<block type="text_append">'
	+     '<value name="TEXT">'
	+       '<shadow type="text"></shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="text_length">'
	+     '<value name="VALUE">'
	+       '<shadow type="text">'
	+         '<field name="TEXT">abc</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="text_isEmpty">'
	+     '<value name="VALUE">'
	+       '<shadow type="text">'
	+         '<field name="TEXT"></field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="text_indexOf">'
	+     '<value name="VALUE">'
	+       '<block type="variables_get">'
	+         '<field name="VAR">text</field>'
	+       '</block>'
	+     '</value>'
	+     '<value name="FIND">'
	+       '<shadow type="text">'
	+         '<field name="TEXT">abc</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="text_charAt">'
	+     '<value name="VALUE">'
	+       '<block type="variables_get">'
	+         '<field name="VAR">text</field>'
	+       '</block>'
	+     '</value>'
	+   '</block>'
	+   '<block type="text_getSubstring">'
	+     '<value name="STRING">'
	+       '<block type="variables_get">'
	+         '<field name="VAR">text</field>'
	+       '</block>'
	+     '</value>'
	+   '</block>'
	+   '<block type="text_changeCase">'
	+     '<value name="TEXT">'
	+       '<shadow type="text">'
	+         '<field name="TEXT">abc</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="text_trim">'
	+     '<value name="TEXT">'
	+       '<shadow type="text">'
	+         '<field name="TEXT">abc</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="text_count">'
	+     '<value name="SUB">'
	+       '<shadow type="text"></shadow>'
	+     '</value>'
	+     '<value name="TEXT">'
	+       '<shadow type="text"></shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="text_replace">'
	+     '<value name="FROM">'
	+       '<shadow type="text"></shadow>'
	+     '</value>'
	+     '<value name="TO">'
	+       '<shadow type="text"></shadow>'
	+     '</value>'
	+     '<value name="TEXT">'
	+       '<shadow type="text"></shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="text_reverse">'
	+     '<value name="TEXT">'
	+       '<shadow type="text"></shadow>'
	+     '</value>'
	+   '</block>'
	+   '<label text="Input/Output:" web-class="ioLabel"></label>'
	+   '<block type="text_print">'
	+     '<value name="TEXT">'
	+       '<shadow type="text">'
	+         '<field name="TEXT">abc</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="text_prompt_ext">'
	+     '<value name="TEXT">'
	+       '<shadow type="text">'
	+         '<field name="TEXT">abc</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+ '</category>'
	+ '<category name="%{BKY_LISTS_NAME}" colour="%{BKY_LISTS_HUE}">'
	+   '<block type="lists_create_with">'
	+     '<mutation items="0"></mutation>'
	+   '</block>'
	+   '<block type="lists_create_with"></block>'
	+   '<block type="lists_repeat">'
	+     '<value name="NUM">'
	+       '<shadow type="math_number">'
	+         '<field name="NUM">5</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="lists_length"></block>'
	+   '<block type="lists_isEmpty"></block>'
	+   '<block type="lists_indexOf">'
	+     '<value name="VALUE">'
	+       '<block type="variables_get">'
	+         '<field name="VAR">list</field>'
	+       '</block>'
	+     '</value>'
	+   '</block>'
	+   '<block type="lists_getIndex">'
	+     '<value name="VALUE">'
	+       '<block type="variables_get">'
	+         '<field name="VAR">list</field>'
	+       '</block>'
	+     '</value>'
	+   '</block>'
	+   '<block type="lists_setIndex">'
	+     '<value name="LIST">'
	+       '<block type="variables_get">'
	+         '<field name="VAR">list</field>'
	+       '</block>'
	+     '</value>'
	+   '</block>'
	+   '<block type="lists_getSublist">'
	+     '<value name="LIST">'
	+       '<block type="variables_get">'
	+         '<field name="VAR">list</field>'
	+       '</block>'
	+     '</value>'
	+   '</block>'
	+   '<block type="lists_split">'
	+     '<value name="DELIM">'
	+       '<shadow type="text">'
	+         '<field name="TEXT">,</field>'
	+       '</shadow>'
	+     '</value>'
	+   '</block>'
	+   '<block type="lists_sort"></block>'
	+   '<block type="lists_reverse"></block>'
	+ '</category>'
	+ '<sep></sep>'
	+ '<category name="%{BKY_VARIABLES_NAME}" colour="%{BKY_VARIABLES_HUE}" custom="VARIABLE"></category>'
	+ '<category name="%{BKY_PROCEDURES_NAME}" colour="%{BKY_PROCEDURES_HUE}" custom="PROCEDURE"></category>';
	
</script>

<xml id="toolbox" style="display: none">
	<!-- 工具箱系統積木XML結構內容 -->	
	<script>
		document.write(toolbox_standard);
	</script>
	
	<sep></sep>
	
	<!-- 工具箱自訂積木XML結構內容(toolbox.xml) -->
	
	<category name="%{BKY_HELLOWORLD_NAME}" colour="%{BKY_HELLOWORLD_HUE}">
		<block type="test1">
			<value name="message">
				<block type="text">
					<field name="TEXT">Hello World</field>
				</block>
			</value> 		
		</block>
		<block type="test2">		
		</block>		
	</category>
</xml>
	
<xml id="startBlocks" style="display: none">
	<!-- 工作區初始積木XML結構內容 -->

	<block type="test1" x="100" y="100">
		<value name="message">
			<block type="text">
				<field name="TEXT">Hello World</field>
			</block>
		</value> 		
	</block>
</xml>

<script>	

	//圖示音效媒體資料夾路徑
	var media = 'media/';

	//工作區初始化
	var demoWorkspace = Blockly.inject(
		'blocklyDiv'
		,{
			media: media, 
			toolbox: document.getElementById('toolbox'),
			zoom:{
				controls: true,
				wheel: false,
				startScale: 1.0,
				maxScale: 3,
				minScale: 0.3,
				scaleSpeed: 1.2
			},
			move: {
				scrollbars: {
				  horizontal: true,
				  vertical: true
				},
				drag: true,
				wheel: true
			},
			trashcan: true
		}
	);

	//初始積木匯入工作區
	function startBlocks() {
		Blockly.getMainWorkspace().clear();
		Blockly.Xml.domToWorkspace(document.getElementById('startBlocks'), demoWorkspace);
	}
	//startBlocks();

	//監聽工作區改變輸出程式碼
	function onWorkspaceChanged(event) {
		var code = Blockly.Python.workspaceToCode(demoWorkspace);
		console.clear();
		console.log(code);
	}
	demoWorkspace.addChangeListener(onWorkspaceChanged);

	//執行工作區程式碼
	function runCode() {
		var code = Blockly.Python.workspaceToCode(demoWorkspace);
		try {
			eval(code);
		} catch (e) {
			alert(e);
		}
	}
	
	//工作區匯出PY檔案
	function workspaceExportToPY() {
		  try {
			var code = Blockly.Python.workspaceToCode(demoWorkspace);
					
			var link = document.createElement('a');
			link.download="test.py";
			link.href="data:application/octet-stream;utf-8," + encodeURIComponent(code);
			document.body.appendChild(link);
			link.click();
			link.remove();
		  } catch (e) {
			window.location.href="data:application/octet-stream;utf-8," + encodeURIComponent(xml);
			alert(e);
		  }		
	}

	//工作區執行程式碼
	Blockly.Msg["WORKSPACE_SORRY"] = "This feature requires a Node.js environment and a Python installation.";
	function workspaceExecutePY() {
		if (typeof require !== "undefined") {
			var code = Blockly.Python.workspaceToCode(workspace);
			var Prefix = (code.indexOf("input(")!=-1)?"start ":"";
			var autoClose = (code.indexOf("input(")!=-1)?"\nprint()\nprint()\nprint()\ncloseWindow = input('Press Enter to exit')\nexit(0)":"";
			code += autoClose;
			
			const fs = require('fs');
			var filePath = "temp.py";
			fs.writeFile(filePath, code, (err) => { 
				if (err) { 
					console.log(err);
				} else {
					var exec = require('child_process').exec;
					const Path = require('path');
					if (fs.existsSync('python-3.10.0\\App\\Python\\python.exe'))
						var res = exec(Prefix + 'python-python-3.10.0\\App\\Python\\python '+filePath, {encoding: 'arraybuffer'});   //Portable
					else
						var res = exec(Prefix + 'py '+filePath, {encoding: 'arraybuffer'});    //Local
					
					var iconv = require('iconv-lite');
					var message = "";
					res.stdout.on('data', function(data) {
						data = iconv.decode(data, 'big5');
						message += data.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>").replace(/ /g,"&ensp;");
						console.log(message);						
					});

					res.stderr.on('data', function(data) {
						data = iconv.decode(data, 'big5');
						message += data.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>").replace(/ /g,"&ensp;");
						console.log(message);						
					});

					res.on('exit', function(code, signal) {
					});						
				}
			}); 			
		}
		else
			alert(Blockly.Msg["WORKSPACE_SORRY"]);
	}

	//工作區匯出積木結構XML檔案
	function workspaceExportToXML() {
		  try {
			var xml = Blockly.Xml.workspaceToDom(demoWorkspace);
			xml = Blockly.Xml.domToText(xml);

			var link = document.createElement('a');
			link.download="test.xml";
			link.href="data:application/octet-stream;utf-8," + encodeURIComponent(xml);
			document.body.appendChild(link);
			link.click();
			link.remove();
		  } catch (e) {
			window.location.href="data:application/octet-stream;utf-8," + encodeURIComponent(xml);
			alert(e);
		  }		
	}

	//工作區匯入積木結構XML檔案
	function workspaceImportFromXML() {
		var e = document.getElementById("importBlocks");
		if (e) {
			e.click();
			return;
		}

		var input=document.createElement('input');
		input.type="file";
		input.id="importBlocks";
		input.style.display = "none";
		input.accept=".xml";
		input.onchange = function(element) {
			try {	
				var file = this.files[0];
				if (file) {
					var fr = new FileReader();           
					fr.onload = function (event) {
						Blockly.getMainWorkspace().clear();
						var blocks = Blockly.Xml.textToDom(event.target.result);
						Blockly.Xml.domToWorkspace(blocks, Blockly.mainWorkspace);
					};
					fr.readAsText(file);
				}
			} catch (e) {
				alert(e);
			}	  
		}

		document.body.appendChild(input);
		setTimeout(function(){
			input.click();
		},500);	
	}

	//新增工作區功能選單 重設工作區
	Blockly.Msg["WORKSPACE_RESET"] = "Reset Workspace";
	function registerWorkspaceReset() {
	  if (Blockly.ContextMenuRegistry.registry.getItem('workspace_reset')) {
		return;
	  }
	  const workspaceReset = {
		displayText: function(){
			return Blockly.Msg["WORKSPACE_RESET"];
		},
		preconditionFn: function(a) {
			return 'enabled';
		},
		callback: function(a) {
			startBlocks();
		},
		scopeType: Blockly.ContextMenuRegistry.ScopeType.WORKSPACE,id: 'workspace_reset',
		weight: 200,
	  };
	  Blockly.ContextMenuRegistry.registry.register(workspaceReset);
	}
	registerWorkspaceReset();

	//新增工作區功能選單 匯出積木結構XML檔
	Blockly.Msg["WORKSPACE_BLOCKS_EXPORT_XML_MSG"] = "Export Workspace Blocks as XML File";
	function registerWorkspaceBlocksExportToXML() {
	  if (Blockly.ContextMenuRegistry.registry.getItem('workspace_blocks_export_xml')) {
		return;
	  }
	  const workspaceBlocksExportToXML = {
		displayText: function(){
			return Blockly.Msg["WORKSPACE_BLOCKS_EXPORT_XML_MSG"];
		},
		preconditionFn: function(a) {
			return 'enabled';
		},
		callback: function(a) {
			workspaceExportToXML();
		},
		scopeType: Blockly.ContextMenuRegistry.ScopeType.WORKSPACE,id: 'workspace_blocks_export_xml',
		weight: 201,
	  };
	  Blockly.ContextMenuRegistry.registry.register(workspaceBlocksExportToXML);
	}
	registerWorkspaceBlocksExportToXML();

	//新增工作區功能選單 匯入積木結構XML檔
	Blockly.Msg["WORKSPACE_BLOCKS_IMPORT_XML_MSG"] = "Import Workspace Blocks from XML File";
	function registerWorkspaceBlocksImportFromXML() {
	  if (Blockly.ContextMenuRegistry.registry.getItem('workspace_blocks_import_xml')) {
		return;
	  }
	  const workspaceBlocksImportFromXML = {
		displayText: function(){
			return Blockly.Msg["WORKSPACE_BLOCKS_IMPORT_XML_MSG"];
		},
		preconditionFn: function(a) {
			return 'enabled';
		},
		callback: function(a) {
			workspaceImportFromXML();
		},
		scopeType: Blockly.ContextMenuRegistry.ScopeType.WORKSPACE,id: 'workspace_blocks_import_xml',
		weight: 202,
	  };
	  Blockly.ContextMenuRegistry.registry.register(workspaceBlocksImportFromXML);
	}
	registerWorkspaceBlocksImportFromXML();
	
	//新增工作區功能選單 匯出PYTHON檔
	Blockly.Msg["WORKSPACE_BLOCKS_EXPORT_PY_MSG"] = "Export Workspace as PY File";
	function registerWorkspaceBlocksExportToPY() {
	  if (Blockly.ContextMenuRegistry.registry.getItem('workspace_blocks_export_py')) {
		return;
	  }
	  const workspaceBlocksExportToPY = {
		displayText: function(){
			return Blockly.Msg["WORKSPACE_BLOCKS_EXPORT_PY_MSG"];
		},
		preconditionFn: function(a) {
			return 'enabled';
		},
		callback: function(a) {
			workspaceExportToPY();
		},
		scopeType: Blockly.ContextMenuRegistry.ScopeType.WORKSPACE,id: 'workspace_blocks_export_py',
		weight: 203,
	  };
	  Blockly.ContextMenuRegistry.registry.register(workspaceBlocksExportToPY);
	}
	registerWorkspaceBlocksExportToPY();
	
	//新增工作區功能選單 匯出PYTHON檔並執行
	Blockly.Msg["WORKSPACE_BLOCKS_EXECUTE_PY_MSG"] = "Run the Code";
	function registerWorkspaceBlocksExecutePY() {
	  if (Blockly.ContextMenuRegistry.registry.getItem('workspace_blocks_execute_py')) {
		return;
	  }
	  const workspaceBlocksExecutePY = {
		displayText: function(){
			return Blockly.Msg["WORKSPACE_BLOCKS_EXECUTE_PY_MSG"];
		},
		preconditionFn: function(a) {
			return 'enabled';
		},
		callback: function(a) {
			workspaceExecutePY();
		},
		scopeType: Blockly.ContextMenuRegistry.ScopeType.WORKSPACE,id: 'workspace_blocks_execute_py',
		weight: 204,
	  };
	  Blockly.ContextMenuRegistry.registry.register(workspaceBlocksExecutePY);
	}
	registerWorkspaceBlocksExecutePY();	

	//工作區範圍最大化
	function workspaceResize() {
		if (document.documentElement.clientWidth)
			var workspaceWidth = document.documentElement.clientWidth;
		else
			var workspaceWidth = document.body.clientWidth;
		if (document.documentElement.clientHeight)
			var workspaceHeight = document.documentElement.clientHeight-1;
		else
			var workspaceHeight = document.body.clientHeight-1;
		document.getElementById('blocklyDiv').style.width = workspaceWidth +"px";
		document.getElementById('blocklyDiv').style.height = workspaceHeight +"px";
		Blockly.svgResize(demoWorkspace);
	}

	document.addEventListener("DOMContentLoaded", function(event) {
		workspaceResize();
	})

	window.addEventListener("resize", function(){
		workspaceResize();
	})

</script>
</body>
</html>
